{% extends "base.html" %}
{% load static %}

{% block title %}領収書の確認{% endblock title %}

{% block content %}
<h1 class="text-3xl font-bold mb-4">領収書の確認</h1>

<h2 class="text-2xl font-bold mb-2">領収書の仕分け表</h2>
<table class="min-w-full bg-white border-collapse border border-gray-300">
  <thead>
    <tr>
      <th class="py-2 border border-gray-300">領収書番号</th>
      <th class="py-2 border border-gray-300">仕分けパターン</th>
      <th class="py-2 border border-gray-300">項目情報</th>
      <th class="py-2 border border-gray-300">参考パターン</th>
      <th class="py-2 border border-gray-300">判断根拠</th>
    </tr>
  </thead>
  <tbody id="receipt-table-body">
    <!-- 領収書の仕分け表のデータがここに追加されます -->
  </tbody>
</table>

<h2 class="text-2xl font-bold mt-6 mb-2">領収書項目表</h2>
<table class="min-w-full bg-white border-collapse border border-gray-300">
  <thead>
    <tr>
      <th class="py-2 border border-gray-300">項目ID</th>
      <th class="py-2 border border-gray-300">領収書番号</th>
      <th class="py-2 border border-gray-300">商品名</th>
      <th class="py-2 border border-gray-300">商品種別</th>
      <th class="py-2 border border-gray-300">単価</th>
      <th class="py-2 border border-gray-300">個数</th>
      <th class="py-2 border border-gray-300">金額</th>
    </tr>
  </thead>
  <tbody id="item-table-body">
    <!-- 領収書項目表のデータがここに追加されます -->
  </tbody>
</table>

<button type="button" id="save-button2" class="bg-green-500 text-bold py-2 px-4 rounded mt-4">CSVに保存</button>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const mockReceiptData = [
        {
            company: "サンプル株式会社",
            date: "2024-05-31",
            items: [
                { name: "商品A", price: 1000 },
                { name: "商品B", price: 2000 }
            ],
            total: 3000
        },
        {
            company: "テスト商事",
            date: "2024-06-01",
            items: [
                { name: "商品C", price: 1500 },
                { name: "商品D", price: 2500 }
            ],
            total: 4000
        }
    ];

    // Mock Data for Receipts
    mockReceiptData.forEach((receipt, index) => {
        addReceiptRow(receipt, index);
        receipt.items.forEach((item, itemIndex) => {
            addItemRow(item, index, itemIndex);
        });
    });
});

function addReceiptRow(receipt, index) {
    const receiptTableBody = document.getElementById('receipt-table-body');

    const row = document.createElement('tr');
    row.innerHTML = `
        <td class="py-2 border border-gray-300">${index + 1}</td>
        <td class="py-2 border border-gray-300">パターン${index + 1}</td>
        <td class="py-2 border border-gray-300">${receipt.company} ${receipt.date}</td>
        <td class="py-2 border border-gray-300">参考パターン${index + 1}</td>
        <td class="py-2 border border-gray-300">根拠${index + 1}</td>
    `;
    receiptTableBody.appendChild(row);
}

function addItemRow(item, receiptIndex, itemIndex) {
    const itemTableBody = document.getElementById('item-table-body');

    const row = document.createElement('tr');
    row.innerHTML = `
        <td class="py-2 border border-gray-300">${receiptIndex + 1}-${itemIndex + 1}</td>
        <td class="py-2 border border-gray-300">${receiptIndex + 1}</td>
        <td class="py-2 border border-gray-300">${item.name}</td>
        <td class="py-2 border border-gray-300">種別${itemIndex + 1}</td>
        <td class="py-2 border border-gray-300">${item.price}</td>
        <td class="py-2 border border-gray-300">1</td>
        <td class="py-2 border border-gray-300">${item.price}</td>
    `;
    itemTableBody.appendChild(row);
}

document.getElementById('save-button2').addEventListener('click', function() {
    window.location.href = "/save_to_csv";
});
</script>
{% endblock content %}
